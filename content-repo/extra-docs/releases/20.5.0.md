## Cortex XSOAR Content Release Notes for version 20.5.0 (52248)
##### Published on 12 May 2020

**End Of Life Notice**: *Palo Alto Networks Cortex* Integration will reach end of life on May 31st. This is due to changes in the Cortex Data Lake move to a new version 2.0 API. Please make sure to use the *Cortex Data Lake* Integration instead.

### Integrations

####  10 New Integrations
- __Zabbix__

Allow integration with Zabbix api.
- __Microsoft Graph Device Management (Microsoft Intune)__

Microsoft Intune is a Microsoft cloud-based management solution that provides for mobile device and operating system management.

- __Endace__

  - The EndaceProbe Analytics Platform provides 100% accurate, continuous packet capture on network links up to 100Gbps, with unparalleled depth of storage and retrieval performance.  Coupled with the Endace InvestigationManager, this provides a central search and data-mining capability across a fabric of EndaceProbes deployed in a network.
  - This integration uses Endace APIs to search, archive and download PCAP file from either a single EndaceProbe or many via the InvestigationManager and enables integration of full historical packet capture into security automation workflows.
- __Maltiverse__

Use the Maltiverse integration to analyze suspicious hashes, URLs, domains and IP addresses.
- __Malwarebytes__

Scan and Remediate threats on endpoints in the Malwarebytes cloud.
- __MITRE ATT&CK__

Fetch MITRE’s Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK®) content via a feed. MITRE ATT&CK® is a globally-accessible knowledge base of adversary tactics and techniques based on real-world observations. The ATT&CK knowledge base is used as a foundation for the development of specific threat models and methodologies in the private sector, in government, and in the cybersecurity product and service community.

####  52 Improved Integrations
- __Palo Alto Networks AutoFocus v2__

Added support for improved error messages for server connection issues.
- __OTRS__
  - Fixed an issue with the *article* argument in the ***otrs-update-ticket*** command.
  - Added support for fetching a ticket by ticket number in the ***otrs-get-ticket*** command.
- __Cisco Threat Grid__

Fixed an issue where the ***threat-grid-upload-sample*** command did not work as expected while in insecure mode.

- __VirusTotal__

Fixed an issue where urls with a comma were parsed incorrectly.
- __Cisco ASA__

Fixed an issue in which a command completes but an error is raised.
- __EWS v2__

  - Command - "ews-get-items", add Email entry context by demisto standards as an output.
  - Fixed an issue where an error occurred while getting emails with malformed attachments.
- __OpenLDAP (Beta)__

Fixed LDAP authentication when running the integration on an engine.
- __McAfee DAM__

Updated the detailed description.
- __Okta v2__

Fixed an issue where the ***okta-verify-push-factor*** command failed when an HTTP 201 code was returned.
- __Cortex Data Lake__

  - Fixed exception parsing.
  - Added a retry mechanism when requesting an access token from a refresh token.
  - Fixed an issue with the *dest_port* and *source_port* arguments were not processed correctly in the ***cdl-query-traffic-logs*** and ***cdl-query-threat-logs*** commands.
- __McAfee Threat Intelligence Exchange__

Fixed an issue where running the ***tie-file-references*** command on TIE server version 3.0.0 raised an error.
- __Pentera__

  - Changed API default port from 8181 to 5555 and parsed hashes from password cracking operations.
  - Now raw NTLM, NTLMv1 and NTLMv2 will be hidden. NTLMv1/2 will be parsed to expose the username and.
  - its domain or hostname.
- __Carbon Black Defense__

Fixed an issue where the context output for ***cbd-get-alert-details*** was incorrect.
- __Expanse__

Added support for the ***expanse-get-exposures*** command.
- __Alexa Rank Indicator__

Fixed an issue where the integration failed to retrieve the correct rank.
- __PhishLabs IOC__

Fixed an issue where ***fetch-incidents*** did not work as expected.
- __Google Cloud Compute__

Added ***gcp-compute-project-info-add-metadata*** command, which enables adding or updating project-wide metadata.
- __Export Indicators Service__

  - Fixed an issue where ***eis-update*** command failed when *query* argument is not supplied.
  - Removed *Long Running Instance* from instance configuration.
- __ProtectWise__

Added the *token* parameter to the integration instance configuration. This is your ProtectWise API token.
- __ServiceNow v2__

  - Added 5 commands:.
    - ***servicenow-query-items***
    - ***servicenow-get-item-details***
    - ***servicenow-create-item-order***
    - ***servicenow-add-tag***
    - ***servicenow-document-route-to-queue***
  - Improved documentation regarding the usage of the ***impact*** and the ***urgency*** arguments for the commands:.
    - ***servicenow-update-ticket***
    - ***servicenow-create-ticket***
  - Added the *system_params* argument to the ***servicenow-query-table***, ***servicenow-query-tickets*** commands.
- __Hello World__
  - Improved Test Playbook reliability.
  - Added Standard Context data for domain output.
  - Converted output timestamps in ISO8601.
  - Minor bug fixes.
  - Support for Common functions and CommandResults.
- __Infoblox__

Fixed an issue where arguments for create_rpz_rule function were switched.
- __iDefense__

Fixed an issue in the ***url*** command.
- __Slack v2__

- Removed *Long Running Instance* from instance configuration.
- __AWS - AccessAnalyzer (beta)__
Fix incorrect YAML definition of the integration.
- __Generic SQL__

  - Fixed an issue where empty query results raised an error.
  - Added support for SSL connections.
- __Carbon Black Enterprise Live Response__

Fixed an issue where the description for deprecated commands did not refer to commands that replace them.
- __Attivo Botsink__

Fixed an issue where the commands did not work properly.
- __Palo Alto Networks PAN-OS__

Fixed an issue where commands resulting with an empty list would raise an error instead of a warning.
- __Salesforce__

  Added 4 commands.
  - **salesforce-get-casecomment**.
  - **salesforce-post-casecomment**.
  - **salesforce-get-user**.
  - **salesforce-get-org**.
- __CrowdStrike Falcon Streaming v2__

Removed *Long Running Instance* from instance configuration.
- __Netskope__

Fixed an issue where ***fetch-incidents*** command did not work as expected.
- __Microsoft Graph Groups__

Added support to authenticate using a self-deployed Azure application.
- __IntSights__

Fixed an issue where *IsClosed* flag was not fetched properly in ***intsights-get-alert-by-id*** and ***intsights-get-alerts*** commands.
- __IBM QRadar__

Fixed an issue where the test module did not work as expected.
- __Microsoft Graph User__

Added the ***msgraph-direct-reports*** command, which retrieves a user's direct reports.
- __Lockpath KeyLight v2__

Added *kl-get-user-by-id* command.
- __Mail Sender (New)__

Added support for the *SSL/TLS* parameter to configure SSL/TLS connection, which is not STARTTLS.
- __GitHub__

Added handling for deleted forked repositories in the ***GitHub-get-pull-request*** command.
- __Palo Alto Networks PAN-OS EDL Service__
  - Removed *Long Running Instance* from instance configuration.
  - Set the listener host to 0.0.0.0 in order to handle IPv6.
- __Microsoft Graph Files__

Added support to authenticate using a self-deployed Azure application.
- __FireEye ETP__

Fixed an issue where the ***fireeye-etp-search-messages*** command failed.
- __Vectra v2__

Fixed an issue where the ***fetch-incidents*** command failed due to incorrect date format.
- __Symantec Data Loss Prevention (Beta)__
  - Improved handling of proxy and insecure parameters.
  - Fixed issue where *symantec-dlp-get-incident-details* would in some cases return an error.
  - Improved documentation to describe format required for Active Directory accounts.


### 2 Deprecated integrations
- __PostgreSQL__

Integration has been deprecated. Use the Generic SQL itegration instead.
- __Elasticsearch__

Use the Elasticsearch v2 integration instead.


---
### Feeds  (Available from Cortex XSOAR 5.5)
#### New Feed
- __GCP Whitelist Feed__ 

Use the Google Cloud Platform whitelist integration to get indicators from the feed.

#### 9 Improved feeds
- __TAXII Server__ 

Removed *Long Running Instance* from instance configuration.
- __Fastly Feed__ 

Set the default value for the *bypass exclusion list* parameter to "true".
- __Prisma Access Egress IP Feed__ 

Set the default value for the *bypass exclusion list* parameter to "true".
- __Office 365 Feed__ 

Set the default value for the *bypass exclusion list* parameter to "true".
- __AWS Feed__ 

Set the default value for the *bypass exclusion list* parameter to "true".
- __Azure Feed__

Set the default value for the *bypass exclusion list* parameter to "true".
- __Microsoft Intune Feed__ 

Set the default value for the *bypass exclusion list* parameter to "true".
- __Cloudflare Feed__ 

Set the default value for the *bypass exclusion list* parameter to "true".
- __TAXII Feed__ 

Added authentication using certificate key and text file.
---
### Scripts

####  6 New Scripts
- __ConvertToSingleElementArray__

Converts a single string to an array of that string.
- __EvaluateMLModllAtProduction__

Evaluates an ML model in production.
- __ChangeContext__

Enables changing context in two ways. The first is to capitalize the first letter of each key in following level of the context key entered. The second is to change context keys to new values.
- __PenteraDynamicTable__

Renders a Markdown Table from penteraoperationdetails field in Pentera Insight incidents.
- __PenteraOperationToIncident__

Groups Pentera Full Actions Reports by Operation Type to generate an output usable in creating incidents.
- __SetGridField__

Creates a Grid table from items or key-value pairs.

####  5 Improved Scripts
- __DBotPredictPhishingWords__

Added the option to map automation output to out-of-the-box incidents fields.
- __SanePdfReports__

Fixed logos usage and added failure verbose output.
- __PhishLabsPopulateIndicators__
  - Fixed an issue where email indicators were not classified correctly.
  - Fixed an issue where the script attempted to create indicators with *Attachment* type instead of *File* type.
- __PcapHTTPExtractor__

Fixed an issue where a pcap file which contains only an HTTP response was mishandled.
- __SandboxDetonateFile__

Fixed an issue when some fields are missing from the response.


#### 4 Deprecated Scripts
- __QRadarGetCorrelationLogs__

Use the **QRadarCorrelationLog** playbook instead.
- __QRadarGetOffenseCorrelations__

Use the **QRadar - Get offense correlations v2** playbook instead.
- __DocumentationAutomation__

Deprecated. We recommend using the demisto-sdk to generate documentation. For full details see the [dev hub docs](https://xsoar.pan.dev/docs/integrations/integration-docs).
- __HTMLDocsAutomation__

Deprecated. We recommend using the demisto-sdk to generate documentation. For full details see the [dev hub docs](https://xsoar.pan.dev/docs/integrations/integration-docs).


---
### Playbooks

####  21 New Playbooks
- __PAN-OS EDL Setup v3__
  - Configures an external dynamic list in PAN-OS.
  - In the event that the file exists on the web server, it will sync it to demisto. Then it will create an EDL object and a matching rule.
- __Malwarebytes - Isolate Endpoint__

Isolate endpoints in Malwarebytes Cloud.
- __Continuously Process Survey Responses__

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the playbook during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the playbook to help us identify issues, fix them, and continually improve. Continuously processes new questionnaire responses as they are received.
- __TIM - Process Azure indicators__

This playbook handles the tagging of Azure indicators. Specify the tag to apply to these indicators in the playbook inputs. An example tag will be approved_white. If no inputs are specified, the indicators will be tagged for manual review. The user can specify whether a manual review incident is required.
- __TIM - Process Office365 indicators__

This playbook handles the tagging of Office365 indicators. Specify the tag to apply to these indicators in the playbook inputs. An example tag will be approved_white. If no inputs are specified, the indicators will be tagged for manual review. The user can specify whether a manual review incident is required.
- __TIM - Process AWS indicators__

This playbook handles the tagging of AWS indicators. Specify the tag to apply to these indicators in the playbook inputs. An example tag will be approved_white. If no inputs are specified, the indicators will be tagged for manual review. The user can specify whether a manual review incident is required.
- __TIM - Review Indicators Manually For Whitelisting__

This playbook helps analysts manage the manual process of whitelisting indicators from cloud providers, apps, services etc . The playbook indicator query is set to search for indicators that have the 'whitelist_review' tag. The playbooks layout displays all of the related indicators in the summary page. While reviewing the indicators, the analyst can go to the summary page and tag the indicators accordingly with tags such as, 'approved_black', 'approved_white', etc. Once the analyst completes the review, the playbook can optionally send an email with a list of changes done by the analyst which haven't been approved. Once complete, the playbook removes the 'whitelist review' tag from the indicators.
- __Endace Search Archive and Download__

This playbook uses Endace APIs to search, archive and download PCAP file from either a single EndaceProbe or many via the InvestigationManager and enables integration of full historical packet capture into security automation workflows.
- __Pentera Filter And Create Incident__

Sub-playbook to select specific entries from the Pentera action report and create incidents for each of the selected entries.
- __Prisma Cloud Remediation - GCP VPC Network Firewall Misconfiguration__

This playbook remediates the following Prisma Cloud GCP VPC Network Firewall alerts.
- __QRadarCorrelationLog__

This playbook retrieves the correlation logs of multiple QIDs.
- __Hunt Extracted Hashes__
  - This playbook extracts IOCs from the incident details and attached files using regular expressions and then hunts for hashes on endpoints in the organization using available tools.
  - The playbook supports multiple types of attachments. For the full supported attachments list, refer to "Extract Indicators From File - Generic v2".
- __Process Survey Response__

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the playbook during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the playbook to help us identify issues, fix them, and continually improve. This playbook processes the survery responses. It updates that the employee responded to the survey and what their health status is. If necessary, it opens IT or HR incidents, and updates the process survey tracker.
- __Employee Status Survey__

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the playbook during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the playbook to help us identify issues, fix them, and continually improve. Manages a crisis event where employees have to work remotely due to a pandemic, issues with the workplace or similar situations. Sends a questionnaire to all direct reports under a given manager. The questionnaire asks the employees for their health status and whether they need any help. The data is saved as employee indicators in Cortex XSOAR, while IT and HR incidents are created to provide assistance to employees who requested it. The questionnaire expires after 24 hours by default, and during that time the responses are processed every 5 minutes. These settings can be edited via the task that sends the questionnaire and the loop settings of the Continuously Process Survey Responses playbook, respectively.
- __Prisma Cloud Remediation - GCP VPC Network Project Misconfiguration__
  - This playbook remediates the following Prisma Cloud GCP VPC Network Project alerts.
  - Prisma Cloud policies remediated:.
  - GCP project is using the default network.
- __Prisma Cloud Remediation - GCP VPC Network Misconfiguration__
  - This playbook remediates Prisma Cloud GCP VPC Network alerts.  It calls sub-playbooks that perform the actual remediation steps.
- __QRadar - Get offense correlations v2__
  - Run on a QRadar offense to get more information:.
  - * Get all correlations relevant to the offense.
  - * Get all logs relevant to the correlations (not done by default - set "GetCorrelationLogs" to "True").
  
  Inputs:
  - * GetCorrelationLogs (default: False).
  - * MaxLogsCount (default: 20).
- __Endace Search Archive Download PCAP__

  This playbook uses Endace APIs to search, archive and download PCAP file from either a single EndaceProbe or many via the InvestigationManager.      The workflow accepts inputs like “the date and time of the incident or a timeframe”, “source or destination IP address of the incident”,  “source or destination IP port of the incident”,  “protocol of the incident” and name of archive file.
  
  The Workflow in this playbook :
  1. Finds the packet history related to the search items. Multiple Search Items in an argument field are OR'd. Search Items between multiple arguments are AND'd.
  2.  A successful Search is followed by an auto archival process of matching packets on EndaceProbe which can be accessed from an investigation link on the Evidence Board and/or War Room board that can be used to start forensic analysis of the packets history on EndaceProbe.
  3. Finally Download the archived PCAP file to XSOAR system provided the file size is less than a user defined threshold say 10MB. Files greater than 10MB can be accessed or analyzed on EndaceProbe via "Download PCAP link" or "Endace PivotToVision link" displayed on Evidence Board.
- __PAN-OS - Block IP and URL - External Dynamic List v2__
  - This playbook blocks IP addresses and URLs using Palo Alto Networks Panorama or Firewall External Dynamic Lists.
  - It checks if the EDL configuration is in place with the 'PAN-OS EDL Setup' sub-playbook (otherwise the list will be configured), and adds the inputted IPs and URLs to the relevant lists.
- __Pentera Run Scan and Create Incidents__

This playbook will run a pentera task given the Pentera task name. It will generate the full action report that contains all the actions that Pentera made during the scan, and will create incidents according to the filters in the Pentera Filter and Create incidents playbook.
- __Malwarebytes - Scan & Remediate Endpoint__

Scan & Remediate endpoints in Malwarebytes Cloud.

####  19 Improved Playbooks
- __TIM - Process Indicators Against Business Partners Domains List__

Improved conditional task.
- __TIM - Process Indicators Against Business Partners IP List__

Improved conditional task.
- __TIM - Process Indicators Against Approved Hash List__

Improved conditional task.
- __TIM - Process Indicators Against Organizations External IP List__

Improved conditional task.
- __Pentera Run Scan__

Formatting changes and added the Pentera Full Action Report as the playbook output.
- __TIM - Process Indicators Against Business Partners URL List__

Improved conditional task.
- __PAN-OS EDL Setup v2__

Added test playbook.
- __PAN-OS Commit Configuration__
  - Added a better error message when commit or push fails.
  - Added Push/Commit warnings as a playbook output.
- __TIM - Indicator Auto Processing__

Removed default list names and updated playbook logic.
- __TIM - Process Indicators - Fully Automated__

Fixed task name and score.
- __Phishing Investigation - Generic v2__

The playbook now uses Block Indicators - Generic v2 to block malicious indicators (off by default).
- __Impossible Traveler__
  - Simplified the process that gets details of the user's manager.
  - Fixed a potential error with running Active Directory commands when the integration is disabled.

#### 4 Deprecated Playbooks
- __Block Indicators - Generic__

Use the 'Block Indicators - Generic v2' playbook instead.
- __Hunt for bad IOCs__

Use the Search Endpoints By Hash playbook instead.
- __Rapid IOC Hunting Playbook__

Use the Hunt File Hash playbook instead.
- __QRadar - Get offense correlations__

Use the **QRadar - Get offense correlations v2** playbook instead.
---
### Dashboards

####  New Dashboard
- __Employee Health Status__


---
### Incident Fields
#### 17 New Incident Fields
- __What are the areas that need improvement?__

What are the areas that need improvement?.
- __Manager Email__

The email of the manager whose direct reports should be contacted for their health status and offered assistance.
- __What were the areas where the CIRT teams were effective?__

What were the areas where the CIRT teams were effective?.
- __What corrective actions can prevent similar incidents in the future?__

What corrective actions can prevent similar incidents in the future?.
- __Suggestions and discussion of how to improve the team__

Share ideas and information in order to improve team effectiveness in future incidents.
- __What additional tools or resources are needed to detect, analyze, and mitigate future incidents?__

What additional tools or resources are needed to detect, analyze, and mitigate future incidents?.
- __How well did staff and management perform in dealing with the incident? Were the documented procedures followed? Were they adequate?__

How well did staff and management perform in dealing with the incident? Were the documented procedures followed? Were they adequate?.
- __What information was needed sooner?__

What information was needed sooner?.
- __What was the scope of the incident?__

What was the scope of the incident?.
- __When was the problem was first detected and by whom?__

When was the problem was first detected and by whom?.
- __How was the incident contained and eradicated?__

How was the incident contained and eradicated?.
- __Were any steps or actions taken that might have inhibited the recovery?__

Were any steps or actions taken that might have inhibited the recovery?.
- __What was the work performed during recovery?__

What was the work performed during recovery?.
- __What precursors or indicators should be watched for in the future to detect similar incidents?__

What precursors or indicators should be watched for in the future to detect similar incidents?.
- __Exactly what happened, and at what times?__

Exactly what happened, and at what times?.
- __How could information sharing with other organizations have been improved?__

How could information sharing with other organizations have been improved?.
- __What would the staff and management do differently the next time a similar incident occurs?__

What would the staff and management do differently the next time a similar incident occurs?.

---
### Layouts

####  7 New Layouts
- __Pentera Insight - Summary__
- __Review Indicators Manually For Whitelisting - Summary__
- __SANS - Summary__
- __NIST - Summary__
- __MITRE ATT&CK - Indicator Details__
- __Employee Health Check - New/Edit__
- __Employee - Indicator Details__

####  3 Improved Layouts
- __Indicator Feed - New/Edit__

Added edit layout for the **Indicator Feed** incident type.
- __GDPR Data Breach - Summary__

Changed "Date breach information" section from rows to cards.
- __GCP Compute Engine Misconfiguration - Summary__

New layout for 'GCP Compute Engine Misconfiguration'.

